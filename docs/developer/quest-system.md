# ЁЯУЬ р╕гр╕░р╕Ър╕Ър╣Ар╕Др╕зр╕кр╕Хр╣М (Quest System)

р╕гр╕░р╕Ър╕Ър╣Ар╕Др╕зр╕кр╕Хр╣Мр╕Вр╕нр╕З Cosmic Narrative Game р╕Др╕╖р╕нр╕лр╕▒р╕зр╣Гр╕Ир╕кр╕│р╕Др╕▒р╕Нр╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╣Ар╕гр╕╖р╣Ир╕нр╕З р╣Вр╕Фр╕вр╕Цр╕╣р╕Бр╕нр╕нр╕Бр╣Бр╕Ър╕Ър╣Гр╕лр╣Йр╕Чр╕│р╕Зр╕▓р╕Щр╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Ър╕гр╕░р╕Ър╕Ъ **Narrative Scene** р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕гр╣Йр╕▓р╕Зр╕Ыр╕гр╕░р╕кр╕Ър╕Бр╕▓р╕гр╕Ур╣М Storytelling р╕Чр╕╡р╣Ир╕ер╕╖р╣Ир╕Щр╣Др╕лр╕е

---

## ЁЯПЧя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е
р╕гр╕░р╕Ър╕Ър╣Ар╕Др╕зр╕кр╕Хр╣Мр╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Фр╣Йр╕зр╕в 2 р╕Хр╕▓р╕гр╕▓р╕Зр╕лр╕ер╕▒р╕Б:

### 1. `quests_master` (р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Др╕зр╕кр╕Хр╣Мр╕Хр╕▒р╣Йр╕Зр╕Хр╣Йр╕Щ)
р╣Ар╕Бр╣Зр╕Ър╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Вр╕нр╕Зр╣Ар╕Др╕зр╕кр╕Хр╣Мр╕Чр╕╡р╣Ир╕Ьр╕╣р╣Йр╣Ар╕ер╣Ир╕Щр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕гр╕▒р╕Ър╣Др╕Фр╣Й:
- **Slug**: р╕гр╕лр╕▒р╕кр╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕З (р╣Ар╕Кр╣Ир╕Щ `astra_shard_quest`)
- **Giver NPC Slug**: р╕Кр╕╖р╣Ир╕нр╕лр╕гр╕╖р╕н ID р╕Вр╕нр╕З NPC р╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щр╕Ьр╕╣р╣Йр╣Гр╕лр╣Йр╣Ар╕Др╕зр╕кр╕Хр╣М
- **Objective Type**: р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕ар╕▓р╕гр╕Бр╕┤р╕И (`KILL`, `COLLECT`, `EXPLORE`)
- **Objective Count**: р╕Ир╕│р╕Щр╕зр╕Щр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Чр╕│ (р╣Ар╕Кр╣Ир╕Щ р╕Жр╣Ир╕▓р╕бр╕нр╕Щр╕кр╣Ар╕Хр╕нр╕гр╣М 5 р╕Хр╕▒р╕з)

### 2. `player_quests` (р╕Др╕зр╕▓р╕бр╕Др╕╖р╕Ър╕лр╕Щр╣Йр╕▓р╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Ар╕ер╣Ир╕Щ)
р╣Ар╕Бр╣Зр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╣Ар╕Др╕зр╕кр╕Хр╣Мр╕Вр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕Ър╕╕р╕Др╕Др╕е:
- **User ID**: р╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╣Ар╕Др╕зр╕кр╕Хр╣М
- **Status**: р╕кр╕Цр╕▓р╕Щр╕░р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ (`ACTIVE`, `COMPLETED`, `FAILED`)
- **Progress Count**: р╕Ир╕│р╕Щр╕зр╕Щр╕Чр╕╡р╣Ир╕Чр╕│р╣Др╕Фр╣Йр╣Бр╕ер╣Йр╕зр╣Гр╕Щр╕Вр╕Ур╕░р╕Щр╕▒р╣Йр╕Щ

---

## ЁЯФД р╕зр╕Зр╕Ир╕гр╕Кр╕╡р╕зр╕┤р╕Хр╕Вр╕нр╕Зр╣Ар╕Др╕зр╕кр╕Хр╣М (Quest Lifecycle)

### 1. р╕Бр╕▓р╕гр╕гр╕▒р╕Ър╣Ар╕Др╕зр╕кр╕Хр╣М (Quest Acceptance)
р╣Ар╕бр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╣Ар╕ер╣Ир╕Щр╕Др╕╕р╕вр╕Бр╕▒р╕Ъ NPC р╕Чр╕╡р╣Ир╕бр╕╡р╣Ар╕Др╕зр╕кр╕Хр╣М р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Ьр╕╣р╣Йр╣Ар╕ер╣Ир╕Щр╣Ар╕Др╕вр╣Др╕Фр╣Йр╕гр╕▒р╕Ър╣Ар╕Др╕зр╕кр╕Хр╣Мр╕Щр╕╡р╣Йр╕лр╕гр╕╖р╕нр╕вр╕▒р╕З:
- р╕лр╕▓р╕Б **р╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Ар╕Др╕в**: р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Вр╕лр╕ер╕Фр╕Йр╕▓р╕Бр╣Вр╕лр╕бр╣Вр╕гр╕З (`[quest_slug]-intro`)
- р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕ер╕╖р╕нр╕Бр╕Хр╕нр╕Ър╕Хр╕Бр╕ер╕З: р╕Ир╕░р╣Ар╕Бр╕┤р╕Ф Action `ACCEPT_QUEST` р╣Ар╕Юр╕╖р╣Ир╕нр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕ер╕Зр╕Хр╕▓р╕гр╕▓р╕З `player_quests`

### 2. р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Др╕зр╕▓р╕бр╕Др╕╖р╕Ър╕лр╕Щр╣Йр╕▓ (Progress Tracking)
р╣Гр╕Щр╕Вр╕Ур╕░р╕Чр╕│р╣Ар╕Др╕зр╕кр╕Хр╣М р╕лр╕▓р╕Бр╕Др╕╕р╕вр╕Бр╕▒р╕Ъ NPC р╣Ар╕Фр╕┤р╕б:
- р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Вр╕лр╕ер╕Фр╕Йр╕▓р╕Бр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Чр╕│р╕ар╕▓р╕гр╕Бр╕┤р╕И (`[quest_slug]-progress`)
- р╕Лр╕╢р╣Ир╕Зр╕Ир╕░р╕Ър╕нр╕Бр╣Гр╕Ър╣Йр╕лр╕гр╕╖р╕нр╕вр╣Йр╕│р╣Ар╕Хр╕╖р╕нр╕Щр╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕Ьр╕╣р╣Йр╣Ар╕ер╣Ир╕Щр╕Хр╣Йр╕нр╕Зр╕Чр╕│

### 3. р╕Бр╕▓р╕гр╕кр╕│р╣Ар╕гр╣Зр╕Ир╣Бр╕ер╕░р╕кр╣Ир╕Зр╣Ар╕Др╕зр╕кр╕Хр╣М (Completion & Rewards)
р╣Ар╕бр╕╖р╣Ир╕нр╕вр╕нр╕Ф `progress_count` р╕Др╕гр╕Ър╕Хр╕▓р╕бр╕Ир╕│р╕Щр╕зр╕Щр╣Гр╕Щ `quests_master`:
- р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕бр╕нр╕Зр╕зр╣Ир╕▓р╣Ар╕Др╕зр╕кр╕Хр╣Мр╕Щр╕╡р╣Йр╕кр╕Цр╕▓р╕Щр╕░р╕Др╕╖р╕н `READY` (р╕Юр╕гр╣Йр╕нр╕бр╕кр╣Ир╕З)
- р╣Ар╕бр╕╖р╣Ир╕нр╕Др╕╕р╕вр╕Бр╕▒р╕Ъ NPC р╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З: р╕Ир╕░р╣Вр╕лр╕ер╕Фр╕Йр╕▓р╕Бр╕кр╕│р╣Ар╕гр╣Зр╕Ир╕ар╕▓р╕гр╕Бр╕┤р╕И (`[quest_slug]-complete`)
- р╣Ар╕бр╕╖р╣Ир╕нр╕Ир╕Ър╕Йр╕▓р╕Б: р╕Ир╕░р╣Ар╕Бр╕┤р╕Ф Action `REWARD` р╕Лр╕╢р╣Ир╕Зр╕Ир╕░р╕Чр╕│р╕Бр╕▓р╕г:
    1. р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕кр╕Цр╕▓р╕Щр╕░р╣Ар╕Ыр╣Зр╕Щ `COMPLETED`
    2. р╕бр╕нр╕Ъ EXP р╣Бр╕ер╕░ Gold р╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Ар╕ер╣Ир╕Щр╣Вр╕Фр╕вр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

---

## ЁЯЫая╕П р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Др╕зр╕кр╕Хр╣Мр╣Гр╕лр╕бр╣И
1. р╣Ар╕Юр╕┤р╣Ир╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕Зр╣Гр╕Щ `quests_master` р╕Чр╕▓р╕З DevTools
2. р╕кр╕гр╣Йр╕▓р╕З Scene р╕нр╕вр╣Ир╕▓р╕Зр╕Щр╣Йр╕нр╕в 3 р╕Йр╕▓р╕Бр╣Гр╕Щ `narrative_scenes`:
    - `[Slug]-intro`: р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▒р╕Ър╣Ар╕Др╕зр╕кр╕Хр╣М
    - `[Slug]-progress`: р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕зр╕Зр╕Зр╕▓р╕Щ (р╣Гр╕кр╣Ир╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕В `ACTIVE`)
    - `[Slug]-complete`: р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е (р╣Гр╕кр╣Ир╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕В `READY`)
3. р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╣Вр╕вр╕З NPC р╣Ар╕Вр╣Йр╕▓р╕Бр╕▒р╕Ър╕Йр╕▓р╕Бр╕лр╕гр╕╖р╕нр╕Бр╕│р╕лр╕Щр╕Ф `giver_npc_slug` р╣Гр╕лр╣Йр╕Хр╕гр╕Зр╕Бр╕▒р╕Щ

---

## ЁЯОи р╕Вр╣Йр╕нр╣Бр╕Щр╕░р╕Щр╕│р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Вр╕╡р╕вр╕Щр╣Ар╕Щр╕╖р╣Йр╕нр╣Ар╕гр╕╖р╣Ир╕нр╕З
- **Dynamic Dialogue**: р╕Др╕зр╕гр╣Гр╕Кр╣Йр╕Кр╕╖р╣Ир╕нр╕Хр╕▒р╕зр╕ер╕░р╕Др╕гр╕Ьр╕╣р╣Йр╣Ар╕ер╣Ир╕Щр╣Бр╕Чр╕гр╕Бр╣Гр╕Щр╕Ър╕Чр╕Юр╕╣р╕Фр╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕зр╕▓р╕бр╕нр╕┤р╕Щ
- **Narrative Link**: р╣Гр╕Кр╣Йр╕Хр╕▒р╕зр╕ер╕░р╕Др╕гр╕Юр╕┤р╣Ар╕ир╕йр╕нр╕вр╣Ир╕▓р╕З **р╕Др╕▓р╣Ар╕гр╕Щ (Kaelen)** р╣Ар╕Юр╕╖р╣Ир╕нр╕Ър╕нр╕Бр╣Гр╕Ър╣Йр╕Чр╕▓р╕Зр╣Др╕Ыр╣Ар╕бр╕╖р╕нр╕Зр╕Цр╕▒р╕Фр╣Др╕Ыр╕лр╕ер╕▒р╕Зр╕Ир╕Ър╣Ар╕Др╕зр╕кр╕Хр╣Мр╕кр╕│р╕Др╕▒р╕Н
